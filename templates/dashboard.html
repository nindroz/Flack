{% extends "layout.html" %}

{% block title %}
Dashboard
{% endblock %}

{% block body %}
<h1>WELCOME {{name}}
</h1>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript">

    document.addEventListener('DOMContentLoaded',() => {
    // Connect to websocket
    var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);

    socket.on('connect', () => {

        document.querySelector('#form').onsubmit = () => {
            
            const name = document.querySelector('#channelMake').value;
            console.log("make");
            socket.emit("make channel",{"name":name});
            };
        
        document.querySelectorAll('.channel').forEach( channel => {
            channel.onclick = () => {
            console.log("pp");}
        });

        document.querySelector('#sendMessage').onsubmit = () => {
            const msg = document.querySelector("#message").value;
            socket.emit("send message", {"message":message})
        }

        });
    

    socket.on('display name', data => {
        console.log("data");
        const li = document.createElement('li');
        li.innerHTML=data.channelName;
        document.querySelector("channels").append(li);
        });
    });


</script>
<form id="form">
    <input type="text"  id="channelMake">
    <input type="submit" value="make channel">
</form>

{% if channels %}
    <ul id="channels">
        <li><button class = "channel" data-name = {{channel}}>{{channel}}</button></li>
    </ul>
{% endif %}
<hr>

<form id="sendMessage">
    <input type="text" name="message" id="message">
    <input type="submit">
</form>


{% endblock %}